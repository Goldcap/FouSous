build/flame.min.js:.length===0)},this.isSelectable=function(){return this.isEnabled()&&!this.subMenuItems},this.elementSelector=function(){return Ember.$("#%@".fmt(this.id))},this.closeSubMenu=function(){var e=this.subMenuView;Ember.none(e)||(e.close(),this.subMenuView=null)}},Flame.MenuView=Flame.Panel.extend(Flame.ActionSupport,{classNames:["flame-menu"],childViews:["contentView"],contentView:Flame.ScrollView,dimBackground:!1,subMenuKey:"subMenu",itemTitleKey:"title",itemEnabledKey:"isEnabled",itemCheckedKey:"isChecked",itemValueKey:"value",itemActionKey:"action",itemHeight:21,menuMargin:12,minWidth:null,items:[],parentMenu:null,value:null,_allItemsDoNotFit:!0,_anchorElement:null,_menuItems:[],highlightIndex:-1,userHighlightIndex:-1,internalSelection:undefined,init:function(){this._super(),this._needToRecreateItems()},_calculateMenuWidth:function(){var e=this.get("items");if(Ember.get(e,"length")===0)return;var t=this.get("itemTitleKey"),n=e.reduce(function(e,n){var r=Ember.get(n,t);return e+r+"<br/>"},"");return Flame.measureString(n,"ember-view flame-view flame-list-item-view flame-menu-item-view","title").width+16},_createMenuItems:function(){var e=this.get("items"),t=this.get("itemCheckedKey"),n=this.get("itemEnabledKey"),r=this.get("itemTitleKey"),i=this.get("itemValueKey"),s=this.get("subMenuKey"),o=this.get("value"),u;return u=e.map(function(e,u){return new Flame.MenuItem({item:e,isSelected:Ember.get(e,i)===o,isDisabled:Ember.get(e,n)===!1,isChecked:Ember.get(e,t),subMenuItems:Ember.get(e,s),title:Ember.get(e,r),id:this._indexToId(u)})},this),u},_needToRecreateItems:function(){var e=this._createMenuItems();this.set("_menuItems",e),Ember.none(this.get("parentMenu"))&&e.forEach(function(e,t){e.isSelected&&this.set("highlightIndex",t)},this),this.getPath("contentView").setScrolledView(this._createMenuView()),this.get("_anchorElement")&&this._updateMenuSize()}.observes("items","elementId"),_createMenuView:function(){var e=this.get("_menuItems");return Flame.View.create({useAbsolutePosition:!1,render:function(t){var n=e.map(function(e){return e.renderToElement()});t.push(n.join(""))}})},makeSelection:function(){var e=this.get("parentMenu"),t,n;if(!Ember.none(e))e.makeSelection(),this.close();else{var r=this.get("internalSelection");typeof r!="undefined"&&(n=Ember.get(r,this.get("itemValueKey")),this.set("value",n),t=Ember.get(r,this.get("itemActionKey"))||this.get("action")),Ember.run.sync(),this.close(),Ember.none(t)||this.fireAction(t,n)}},createSubMenu:function(e){return Flame.MenuView.create({items:e,parentMenu:this,subMenuKey:this.get("subMenuKey"),itemEnabledKey:this.get("itemEnabledKey"),itemTitleKey:this.get("itemTitleKey"),itemValueKey:this.get("itemValueKey"),itemHeight:this.get("itemHeight"),isModal:!1})},closeCurrentlyOpenSubMenu:function(){var e=this.get("highlightIndex");e>=0&&this.get("_menuItems").objectAt(e).closeSubMenu()},popup:function(e,t){var n=e instanceof jQuery?e:e.$();this._super(n,t),this.set("_anchorElement",n),this._updateMenuSize()},_updateMenuSize:function(){var e=this.get("_anchorElement"),t=5,n=5,r=1,i=t+n,s=this.get("menuMargin"),o=this.get("_menuItems").get("length")*this.get("itemHeight")+i+2*r,u=$(window).height(),a=e.offset().top,f=e.outerHeight(),l=this.get("layout"),c=!Ember.none(this.get("parentMenu")),h=u-a+(c?r+t:-f),p=!1;o+s*2<=u?c&&h>=o+s?l.set("top",a-(r+t)):h<o+s&&l.set("top",u-(o+s)):(o=u-2*s,l.set("top",s),p=!0),l.set("height",o);if(!l.width){var d=Math.max(this.get("minWidth")||0,this._calculateMenuWidth());l.set("width",d)}this.set("layout",l),this.get("contentView").set("needScrolling",p)},close:function(){if(this.isDestroyed)return;this.set("highlightIndex",-1),this._clearKeySearch(),this._super()},mouseDown:function(){return!0},cancel:function(){this.close()},moveUp:function(){return this._selectNext(-1)},moveDown:function(){return this._selectNext(1)},moveRight:function(){return this._tryOpenSubmenu(!0),!0},moveLeft:function(){var e=this.get("parentMenu");return Ember.none(e)||e.closeCurrentlyOpenSubMenu(),!0},insertNewline:function(){return this.makeSelection(),!0},keyPress:function(e){var t=String.fromCharCode(e.which);return e.which>31&&t!==""?(this._doKeySearch(t),!0):!1},handleMouseEvents:function(e){var t=this._idToIndex(e.currentTarget.id),n=!1;return e.type==="mouseenter"?n=this.mouseEntered(t):e.type==="mouseup"?n=this.mouseClicked(t):e.type==="mousedown"&&(n=!0),!n},mouseClicked:function(e){return this.set("highlightIndex",e),this.get("userHighlightIndex")>=0&&this.makeSelection(),!0},mouseEntered:function(e){return this.set("userHighlightIndex",e),this._tryOpenSubmenu(!1),!0},_selectNext:function(e){var t=this.get("_menuItems"),n=t.get("length"),r,i=this.get("highlightIndex")+e;for(;i>=0&&i<n;i+=e){r=t.objectAt(i);if(r.isEnabled()){this.set("highlightIndex",i);break}}return this._clearKeySearch(),!0},_valueDidChange:function(){var e=this.get("value"),t=this.get("itemValueKey");if(!Ember.none(e)&&!Ember.none(t)){var n=this._findIndex(function(n){return Ember.get(n,t)===e});n>=0&&this.set("highlightIndex",n)}}.observes("value"),_internalSelectionDidChange:function(){var e=this.get("internalSelection");Ember.trySetPath(this,"parentMenu.internalSelection",e)}.observes("internalSelection"),_findIndex:function(e){var t=this.get("items"),n=0,r=t.get("length");for(;n<r;n++)if(e(t.objectAt(n)))return n;return-1},_findByName:function(e){var t=new RegExp("^"+e,"i"),n=this.get("itemTitleKey");return this._findIndex(function(e){return t.test(Ember.get(e,n))})},_toggleClass:function(e,t,n){var r=this.get("_menuItems").objectAt(t);r.elementSelector().toggleClass(e,n)},_highlightWillChange:function(){var e=this.get("highlightIndex"),t=this.get("_menuItems").objectAt(e);Ember.none(t)||(this._toggleClass("is-selected",e),t.isSelected=!1,t.closeSubMenu())}.observesBefore("highlightIndex"),_highlightDidChange:function(){var e=this.get("highlightIndex"),t=this.get("_menuItems").objectAt(e),n;Ember.none(t)||(this._toggleClass("is-selected",e),t.isSelected=!0,t.isSelectable()&&(n=t.item)),this.set("internalSelection",n)}.observes("highlightIndex"),_userHighlightIndexDidChange:function(){this.set("highlightIndex",this.get("userHighlightIndex"))}.observes("userHighlightIndex"),_clearKeySearch:function(){Ember.none(this._timer)||Ember.run.cancel(this._timer),this._searchKey=""},_doKeySearch:function(e){this._searchKey=(this._searchKey||"")+e;var t=this._findByName(this._searchKey);t>=0&&this.set("highlightIndex",t),Ember.none(this._timer)||Ember.run.cancel(this._timer),this._timer=Ember.run.later(this,this._clearKeySearch,1e3)},_indexToId:function(e){return"%@-%@".fmt(this.get("elementId"),e)},_idToIndex:function(e){var t=new RegExp("%@-(\\d+)".fmt(this.get("elementId"))),n=t.exec(e);return n&&n.length===2?parseInt(n[1],10):-1},_tryOpenSubmenu:function(e){var t=this.get("highlightIndex"),n=this.get("_menuItems").objectAt(t),r=n.subMenuItems;if(!Ember.none(r)&&n.isEnabled()&&r.get("length")>0){this._clearKeySearch();var i=n.subMenuView;return Ember.none(i)&&(i=this.createSubMenu(r),n.subMenuView=i),i.popup(n.elementSelector(),Flame.POSITION_RIGHT),e&&i._selectNext(1),!0}return!1},didInsertElement:function(){this._super();var e=this,t=this.get("elementId"),n="mouseenter.%@ mouseup.%@ mousedown.%@".fmt(t,t,t);Ember.$("#%@".fmt(t)).on(n,".flame-menu-item-view",function(t){return e.handleMouseEvents(t)})}}),Flame.Popover=Flame.Panel.extend({classNames:["flame-popover"],childViews:[],dimBackground:!1,arrow:"arrow",handlebars:'<img {{bindAttr class="arrowPosition arrow"}} {{bindAttr src="image"}} />{{view contentView}}',anchor:null,position:null,_positionArrow:function(){var e=this.get("anchor"),t=this.get("position"),n=this.$("img.arrow"),r=e.offset(),i;t&(Flame.POSITION_ABOVE|Flame.POSITION_BELOW)?(i=r.left+e.outerWidth()/2-parseInt(this.$().css("left").replace("px",""),10)-15,n.css({left:i+"px"})):(i=r.top+e.outerHeight()/2-parseInt(this.$().css("top").replace("px",""),10)-15,n.css({top:i+"px"}),t&Flame.POSITION_LEFT&&n.css({left:this.getPath("layout.width")-1+"px"}))},_layoutRelativeTo:function(e,t){e=e instanceof jQuery?e:e.$(),this.set("anchor",e),this.set("position",t);var n=this._super(e,t);return n.moved&&(t^=Flame.POSITION_LEFT|Flame.POSITION_RIGHT,n=this._super(e,t),this.set("position",t)),t&Flame.POSITION_ABOVE?(n.top-=15,this.set("arrowPosition","above"),this.set("image",Flame.image("arrow_down.png"))):t&Flame.POSITION_BELOW?(n.top+=15,this.set("arrowPosition","below"),this.set("image",Flame.image("arrow_up.png"))):t&Flame.POSITION_LEFT?(n.left-=15,this.set("arrowPosition","left"),this.set("image",Flame.image("arrow_right.png"))):t&Flame.POSITION_RIGHT&&(n.left+=15,this.set("arrowPosition","right"),this.set("image",Flame.image("arrow_left.png"))),n},didInsertElement:function(){this._positionArrow()},popup:function(e,t){this._super(e,t|Flame.POSITION_MIDDLE)}}),Flame.ProgressView=Flame.View.extend({classNames:["flame-progress-view"],animate:!1,handlebars:function(){var e=this.get("layout").height;return"<div style='height: %@px;' class='progress-container'></div><div style='height: %@px; width: %@px;' class='progress-bar'></div>".fmt(e-2,e-4,this.get("size"))}.property().cacheable(),size:function(){var e=this.get("value")/this.get("maximum");if(isNaN(e))return 0;var t=this.get("layout").width;return e>1&&(e=1),Math.floor(t*e)-4}.property("value","maximum"),_sizeDidChange:function(){Ember.run.next(this,function(){this.get("animate")?this.$(".progress-bar").animate({width:this.get("size")},300):this.$(".progress-bar").css("width",this.get("size"))})}.observes("size")}),Flame.RadioButtonView=Flame.CheckboxView.extend({classNames:["flame-radio-button-view"],action:function(){this.set("targetValue",this.get("value"))},isSelected:function(){return Ember.typeOf(this.get("value"))==="undefined"||Ember.typeOf(this.get("targetValue"))==="undefined"?!1:this.get("value")===this.get("targetValue")}.property("targetValue","value").cacheable(),renderCheckMark:function(e){e.push("<div class='flame-view flame-checkbox-checkmark' style='top:8px;left:8px;width:6px;height:6px;'></div>")}}),Flame.TextFieldView=Flame.View.extend(Flame.ActionSupport,{classNames:["flame-text"],childViews:["textField"],acceptsKeyResponder:!0,layout:{left:0,top:0},defaultHeight:22,defaultWidth:200,value:"",placeholder:null,isPassword:!1,isValid:null,isEditableLabel:!1,isVisible:!0,becomeKeyResponder:function(){this.get("textField").becomeKeyResponder()},insertNewline:function(){return this.fireAction()},textField:Ember.TextField.extend(Flame.EventManager,Flame.FocusSupport,{classNameBindings:["isInvalid","isEditableLabel","isFocused"],acceptsKeyResponder:!0,type:Flame.computed.trueFalse("parentView.isPassword","password","text"),isInvalid:Flame.computed.equals("parentView.isValid",!1),valueBinding:"^value",placeholderBinding:"^placeholder",isEditableLabelBinding:"^isEditableLabel",isVisibleBinding:"^isVisible",keyUp:function(){return this._elementValueDidChange(),!1},insertNewline:function(){return this._elementValueDidChange(),Ember.run.sync(),!1},cancel:function(){return!1},mouseDown:function(){return Flame.ALLOW_BROWSER_DEFAULT_HANDLING},mouseMove:function(){return Flame.ALLOW_BROWSER_DEFAULT_HANDLING},mouseUp:function(){return Flame.ALLOW_BROWSER_DEFAULT_HANDLING}})}),Flame.SearchTextFieldView=Flame.TextFieldView.extend({classNames:["flame-search-field"],cancel:function(){return Ember.empty(this.get("value"))?!1:(Ember.run.next(this,function(){this.set("value","")}),!0)}}),Flame.SelectButtonView=Flame.ButtonView.extend({classNames:["flame-select-button-view"],items:[],value:undefined,defaultHeight:22,itemTitleKey:"title",itemValueKey:"value",itemActionKey:"action",subMenuKey:"subMenu",handlebars:function(){var e=this.get("itemTitleKey");return'<label {{bindAttr title="_selectedMenuItem.%@"}}>{{_selectedMenuItem.%@}}</label><div><img src="%@"></div>'.fmt(e,e,Flame.image("select_button_arrow.png"))}.property("value","_selectedMenuItem").cacheable(),_selectedMenuItem:function(){if(this.get("value")===undefined)return undefined;var e=this._findItem();return e}.property("value","itemValueKey","subMenuKey","items").cacheable(),itemsDidChange:function(){this.get("items")&&this.getPath("items.length")>0&&!this._findItem()&&this.set("value",this.getPath("items.firstObject.%@".fmt(this.get("itemValueKey"))))}.observes("items"),_findItem:function(e){e||(e=this.get("items"));var t=this.get("itemValueKey"),n=this.get("value"),r=this.get("subMenuKey"),i;return Ember.none(e)?i:(e.forEach(function(e){if(Ember.get(e,r)){var s=this._findItem(Ember.get(e,r));Ember.none(s)||(i=s)}else Ember.get(e,t)===n&&(i=e)},this),i)},menu:function(){var e=this;return Flame.MenuView.extend({selectButtonView:this,itemTitleKey:this.get("itemTitleKey"),itemValueKey:this.get("itemValueKey"),itemActionKey:this.get("itemActionKey"),subMenuKey:this.get("subMenuKey"),itemsBinding:"selectButtonView.items",valueBinding:"selectButtonView.value",minWidth:this.getPath("layout.width")||this.$().width(),close:function(){e.gotoState("idle"),this._super()}})}.property(),mouseDown:function(){return this._openMenu(),!1},insertSpace:function(){return this._openMenu(),!0},_openMenu:function(){this.gotoState("mouseDownInside"),this.get("menu").create().popup(this)}}),Flame.StackItemView=Flame.ListItemView.extend({useAbsolutePosition:!0,classNames:["flame-stack-item-view"]}),Flame.StackView=Flame.ListView.extend({layoutManager:Flame.VerticalStackLayoutManager.create({topMargin:0,spacing:0,bottomMargin:0}),allowSelection:!1}),Flame.TabView=Flame.View.extend({classNames:["flame-tab-view"],childViews:"tabBarView contentView".w(),tabs:null,previousTabs:null,nowShowing:null,tabsHeight:23,initializeTabsLazily:!0,init:function(){this._super(),Ember.none(this.get("tabs"))||this._tabsDidChange()},_tabsWillChange:function(){var e=this.get("tabs");Ember.none(e)||this.set("previousTabs",e.slice())}.observesBefore("tabs.@each"),_tabsDidChange:function(){var e=this.get("tabs");if(Ember.none(e))return;var t=this.get("previousTabs");Ember.none(t)||t.forEach(function(t,n){if(Ember.none(e.findProperty("value",t.value))){var r=this.get("tabBarView");r.get("childViews").forEach(function(e){e.get("value")===t.value&&r.removeChild(e)})}},this),e.forEach(function(e,n){(Ember.none(t)||Ember.none(t.findProperty("value",e.value)))&&this._addTab(e,n)},this)}.observes("tabs.@each"),_addTab:function(e,t){var n=this.get("contentView"),r=n.get("childViews"),i=this.get("tabBarView"),s=i.get("childViews"),o=this.get("tabsHeight"),u=this;s.insertAt(t,i.createChildView(Flame.ButtonView.create({acceptsKeyResponder:!1,layout:{top:0,bottom:0,height:o},title:e.title,value:e.value,isSelected:Flame.computed.equals("parentView.parentView.nowShowing",e.value),action:function(){u.set("nowShowing",e.value)}})));var a=u.get(e.value);u.get("initializeTabsLazily")||(a instanceof Ember.View||(a=n.createChildView(a)),a.set("isVisible",!1),r.addObject(a),u.set(e.value,a)),Ember.none(this.get("nowShowing"))&&this.set("nowShowing",this.get("tabs").objectAt(0).value)},_tabWillChange:function(){this.get("nowShowing")&&this.get(this.get("nowShowing")).set("isVisible",!1)}.observesBefore("nowShowing"),_tabDidChange:function(){if(this.get("nowShowing")){var e=this.get("nowShowing"),t=this.get(e);if(!(t instanceof Ember.View)){var n=this.get("contentView");t=n.createChildView(t),n.get("childViews").addObject(t),this.set(e,t)}t.set("isVisible",!0)}}.observes("nowShowing"),tabBarView:Flame.View.extend({classNames:["flame-tab-view-tabs"],layout:{left:0,top:0,right:0,height:"parentView.tabsHeight"}}),contentView:Flame.View.extend({classNames:["flame-tab-view-content"],layout:{left:0,top:"parentView.tabsHeight",right:0,bottom:0}})}),Flame.TableDataView=Flame.View.extend(Flame.Statechart,{classNames:["flame-table-data-view"],acceptsKeyResponder:!0,batchUpdates:!0,updateBatchSize:500,_updateCounter:0,selectedCell:null,editValue:null,contentBinding:"^content",initialState:"loaded",loaded:Flame.State.extend({mouseDown:function(e){return this.get("owner").selectCell(jQuery(e.target))?(this.gotoState("selected"),!0):!1},enterState:function(){this.getPath("owner.state")==="inDOM"&&this.getPath("owner.selection").hide()}}),selected:Flame.State.extend({mouseDown:function(e){var t=jQuery(e.target),n=this.getPath("owner.selectedDataCell");return t.hasClass("table-selection")&&n.options&&n.options()?(this.startEdit(),!0):!!this.get("owner").selectCell(t)},insertNewline:function(e){return this.startEdit()},deleteBackward:function(e){return this.wipeCell(),!0},deleteForward:function(e){this.wipeCell()},wipeCell:function(){var e=this.getPath("owner.selectedDataCell");if(Ember.none(e))return;e.isEditable()&&this.get("owner")._validateAndSet("")},doubleClick:function(){this.startEdit()},startEdit:function(e){var t=this.getPath("owner.selectedDataCell");if(Ember.none(t))return;t.isEditable()?this.gotoState("editing"):t.options()||this.gotoState("selectingReadOnly")},cancel:function(e){return this.get("owner").resignKeyResponder(),!0},moveLeft:function(e){var t=this.getPath("owner.selectedCell");return this.get("owner").selectCell(t.prev()),!0},moveRight:function(e){var t=this.getPath("owner.selectedCell");return this.get("owner").selectCell(t.next()),!0},moveDown:function(e){var t=this.getPath("owner.selectedCell");return this.get("owner").selectCell(jQuery(t.parent().next().children()[t.attr("data-index")])),!0},moveUp:function(e){var t=this.getPath("owner.selectedCell");return this.get("owner").selectCell(jQuery(t.parent().prev().children()[t.attr("data-index")])),!0},insertTab:function(e){return this.get("owner").invokeStateMethodByValuesOn("moveDown","moveRight"),!0},insertBacktab:function(e){return this.get("owner").invokeStateMethodByValuesOn("moveUp","moveLeft"),!0},keyPress:function(e){var t=this.getPath("owner.selectedDataCell");if(Ember.none(t)||t&&!t.isEditable())return!1;var n=String.fromCharCode(e.which);if(e.metaKey)return!1;if(n.match(/[a-zA-Z0-9+*\-\[\/\=]/)){var r=this.get("owner");return r.set("editValue",n),this.startEdit(),!0}return!1},enterState:function(){this.getPath("owner.selection").show()}}),selectingReadOnly:Flame.State.extend({cancel:function(e){return this.get("owner")._cancelEditingOrSelecting(),!0},insertNewline:function(e){var t=this.get("owner");this.gotoState("selected"),t.invokeStateMethodByValuesOn("moveRight","moveDown")},moveLeft:function(e){this._invokeInSelected("moveLeft")},moveRight:function(e){this._invokeInSelected("moveRight")},moveDown:function(e){this._invokeInSelected("moveDown")},moveUp:function(e){this._invokeInSelected("moveUp")},insertTab:function(e){this._invokeInSelected("insertTab")},insertBacktab:function(e){this._invokeInSelected("insertBacktab")},deleteBackward:function(e){return this.gotoState("selected"),!0},mouseDown:function(e){var t=this.get("owner"),n=jQuery(e.target);return t.isCellSelectable(n)?(this.gotoState("selected"),t.selectCell(n),!0):!1},enterState:function(){var e=this.get("owner"),t=e.get("selection"),n=e.get("selectedDataCell"),r=e.editableValue(n,!0);t.html(r),t.addClass("read-only is-selectable")},exitState:function(){var e=this.getPath("owner.selection");e.html(""),e.removeClass("read-only is-selectable")},_invokeInSelected:function(e){var t=this.get("owner");this.gotoState("selected"),t.invokeStateMethod(e)}}),editing:Flame.State.extend({cancel:function(e){return this.get("owner")._cancelEditingOrSelecting(),!0},insertNewline:function(e){var t=this.get("owner");return t._confirmEdit()&&(this.gotoState("selected"),t.invokeStateMethodByValuesOn("moveRight","moveDown")),!0},insertTab:function(e){var t=this.get("owner");return t._confirmEdit()&&(this.gotoState("selected"),t.invokeStateMethod("insertTab")),!0},insertBacktab:function(e){var t=this.get("owner");return t._confirmEdit()&&(this.gotoState("selected"),t.invokeStateMethod("insertBacktab")),!0},mouseDown:function(e){var t=this.get("owner"),n=jQuery(e.target);return t.isCellSelectable(n)&&t._confirmEdit()?(this.gotoState("selected"),t.selectCell(n),!0):!1},enterState:function(){var e=this.get("owner"),t=e.get("selectedCell"),n=e.get("selectedDataCell"),r=e.get("editField"),i=e.getPath("parentView.scrollable"),s=e.get("selection"),o=n.options();if(!n.showEditor(t,e,e.get("content")))if(o){var u=Flame.MenuView.create({minWidth:t.outerWidth(),parent:e,items:o.map(function(t){return{title:t[0],value:t[1],isChecked:t[1]===n.value,action:function(){e.didSelectMenuItem(this.get("value"))}}}),close:function(){this.get("parent").gotoState("selected"),this._super()}});u.popup(t)}else{var a=t.css("backgroundColor");["rgba(0, 0, 0, 0)","transparent"].contains(a)&&(a="white"),r.css({left:parseInt(s.css("left"),10)+parseInt(s.css("border-left-width"),10)+"px",top:parseInt(s.css("top"),10)+parseInt(s.css("border-top-width"),10)+"px",width:s.outerWidth()-parseInt(s.css("border-left-width"),10)-parseInt(s.css("border-right-width"),10)+"px",height:s.outerHeight()-parseInt(s.css("border-top-width"),10)-parseInt(s.css("border-bottom-width"),10)+"px",backgroundColor:a});var f=e.editableValue(n);r.val(f),e.set("editValue",null),r.show(),r.selectRange(1024,1024)}},exitState:function(){var e=this.get("owner"),t=e.get("editField");t.hide(),t.removeClass("invalid")}}),didSelectMenuItem:function(e){var t=this.get("editField");t.val(e||""),this._confirmEdit(),this.invokeStateMethodByValuesOn("moveRight","moveDown")},willLoseKeyResponder:function(){this.set("selectedCell",null),this.gotoState("loaded")},selectedDataCell:function(){var e=this.get("selectedCell");return this.get("data")[e.parent().attr("data-index")][e.attr("data-index")]}.property(),editableValue:function(e,t){var n=this.get("editValue");return n!==null?n:(n=t?e.formattedValue():e.editableValue(),Ember.none(n)?"":n)},didInsertElement:function(){this.set("selection",this.$(".table-selection")),this.set("editField",this.$(".table-edit-field"))},_selectionDidChange:function(){var e=this.get("selectedCell");if(!e)return;var t=this.get("selection"),n=this.getPath("parentView.scrollable"),r=e.position(),i=n.scrollTop(),s=n.scrollLeft(),o=jQuery.browser.webkit?1:2;t.css({left:r.left+s-o+"px",top:r.top+i-o+"px",width:e.outerWidth()-3+"px",height:e.outerHeight()-1+"px"});if(r.top<0)n.scrollTop(i+r.top);else if(r.top+e.outerHeight()>n.outerHeight()){var u=r.top+e.outerHeight()-n.outerHeight();n.scrollTop(u+i+17)}else if(r.left<0)n.scrollLeft(s+r.left);else if(r.left+e.outerWidth()>n.outerWidth()){var a=r.left+e.outerWidth()-n.outerWidth();n.scrollLeft(a+s+17)}}.observes("selectedCell"),_confirmEdit:function(){var e=this.get("editField").val();return this._validateAndSet(e)},_validateAndSet:function(e){var t=this.get("data"),n=this.get("selectedCell"),r=parseInt(n.attr("data-index"),10),i=parseInt(n.parent().attr("data-index"),10),s=t[i][r];if(Ember.compare(s.editableValue(),e)===0)return!0;if(s.validate(e)){var o=this.get("cellUpdateDelegate"),u=[i,r];if(o.cellUpdated(s,e,u)){var a=this.get("dirtyCells").slice();a.push([i,r]),this.set("dirtyCells",a)}return!0}return this.get("editField").addClass("invalid"),!1},_cancelEditingOrSelecting:function(){this.gotoState("selected")},invokeStateMethodByValuesOn:function(e,t){this.get("areValuesOnRows")?this.invokeStateMethod(e):this.invokeStateMethod(t)},selectCell:function(e){return this.getPath("parentView.allowSelection")&&this.isCellSelectable(e)?(this.set("selectedCell",e),!0):!1},isCellSelectable:function(e){return e&&e[0]&&e[0].nodeName==="TD"},updateColumnWidth:function(e,t){var n=this.$("td[data-index=%@]".fmt(e));n.css({width:"%@px".fmt(t)}),this.propertyDidChange("selectedCell")},render:function(e){this._renderElementAttributes(e),this.set("selectedCell",null),this.gotoState("loaded"),this._renderTable(e)},_renderTable:function(e){var t=this.get("data");if(!t)return e;var n=t.length;if(!t[0])return e;var r=t[0].length,i=this.getPath("parentView.defaultColumnWidth"),s=this.getPath("parentView.content.columnLeafs"),o,u="flame-table";this.getPath("parentView.allowSelection")||(u+=" is-selectable"),e=e.begin("table").attr("class",u).attr("width","1px");var a,f;for(a=0;a<n;a++){e.push('<tr data-index="'+a+'">');for(f=0;f<r;f++){var l=t[a][f],c=l?l.cssClassesString():"";o=s[f].get("render_width")||i,jQuery.browser.mozilla&&(o-=5),e.push('<td data-index="%@" class="%@" style="width: %@px;" %@>%@</td>'.fmt(f,c+(f%2===0?" even-col":" odd-col"),o,l&&l.titleValue?'title="%@"'.fmt(l.titleValue()):"",l?l.formattedValue():'<span style="color: #999">...</span>'))}e.push("</tr>")}e=e.end(),e=e.begin("div").attr("class","table-selection").end(),e=e.begin("input").attr("class","table-edit-field").end()},_cellsDidChange:function(){this.manipulateCells(this.get("dirtyCells"),function(e,t,n){var r=(e?e.cssClassesString():"")+(n?" even-col":" odd-col"),i=e.formattedValue(),s=e.titleValue&&e.titleValue();t.className=r,t.innerHTML=Ember.none(i)?"":i,s&&(t.title=s)},++this._updateCounter)}.observes("dirtyCells"),_updatingCellsDidChange:function(){this.manipulateCells(this.get("cellsMarkedForUpdate"),function(e,t,n){if(e.pending)e.pending.isUpdating=!0,t.className+=n?" even-col":" odd-col";else{e.isUpdating=!0;var r=e.cssClassesString()+(n?" even-col":" odd-col");t.className=r}})}.observes("cellsMarkedForUpdate"),manipulateCells:function(e,t,n){var r=this.get("data");if(!e||e.length===0)return;var i=this.$("table.flame-table"),s=i.find("td"),o=e.splice(0,e.length),u=this.get("batchUpdates")?this.get("updateBatchSize"):-1;this._batchUpdate(u,0,n,o,r,s,t)},_batchUpdate:function(e,t,n,r,i,s,o){if(typeof n!="undefined"&&n!=this._updateCounter)return;var u=r.length,a,f,l,c=i[0].length,h=e===-1?u:e;for(var p=t;p<u&&p-t<h;p++){f=r[p];var d=f[0],v=f[1];i[d][v]||(i[d][v]={pending:{}}),l=i[d][v],a=s[d*c+v],a&&o(l,a,v%2===0)}if(p<u){var m=this;Ember.run.next(function(){m._batchUpdate(e,p,n,r,i,s,o)})}}}),Flame.TableView=Flame.View.extend(Flame.Statechart,{classNames:"flame-table-view".w(),childViews:"tableDataView".w(),acceptsKeyResponder:!1,scrollable:null,rowHeader:null,columnHeader:null,tableCorner:null,renderColumnHeader:!0,renderRowHeader:!0,isRowHeaderClickable:!0,isResizable:!0,allowSelection:!1,initialState:"idle",defaultColumnWidth:88,cellUpdateDelegate:null,clickDelegate:null,resizeDelegate:null,content:null,allowRefresh:!0,batchUpdates:!0,contentAdapter:function(){return Flame.TableViewContentAdapter.create({content:this.get("content")})}.property("content").cacheable(),tableDataView:Flame.TableDataView.extend({dataBinding:"^content._data",dirtyCellsBinding:"^content.dirtyCells",areValuesOnRowsBinding:"^content.areValuesOnRows",totalRowIdsBinding:"^content.totalRowIds",totalColumnIdsBinding:"^content.totalColumnIds",cellUpdateDelegateBinding:"^cellUpdateDelegate",cellsMarkedForUpdateBinding:"^content.cellsMarkedForUpdate",batchUpdatesBinding:"^batchUpdates"}),rowDepth:function(){return this.getPath("contentAdapter.rowHeaderRows").map(function(e){return e.length}).max()}.property("contentAdapter.rowHeaderRows").cacheable(),idle:Flame.State.extend({mouseDown:function(e){var t=jQuery(e.target);if(t.is("div.resize-handle")){this.gotoState("resizing");var n=this.get("owner"),r=t.parent();return n.set("resizingCell",r),n.set("dragStartX",e.pageX),n.set("startX",parseInt(t.parent().css("width"),10)),n.set("offset",parseInt(this.getPath("owner.tableCorner").css("width"),10)),n.set("type",r.is(".column-header td")?"column":"row"),!0}return t.closest(".column-header").length?!0:t.is("a")?!0:!1},mouseUp:function(e){var t=this.getPath("owner.clickDelegate");if(t){var n=jQuery(e.target),r,i;if(!!n.closest(".column-header").length&&(r=n.closest("td").attr("data-leaf-index")))return t.columnHeaderClicked&&(i=this.getPath("owner.content.columnLeafs")[r],t.columnHeaderClicked(i,n)),!0;if(!!n.closest(".row-header").length){if(t.rowHeaderClicked){var s=n.closest("td");r=parseInt(s.attr("data-index"),10)/parseInt(s.attr("rowspan")||1,10),i=this.getPath("owner.content._headers.rowHeaders")[r];if(!i)return!1;t.rowHeaderClicked(i,n,r)}return!0}}return!1}}),resizing:Flame.State.extend({mouseMove:function(e){var t=jQuery(e.target),n=this.getPath("owner.resizingCell"),r=e.pageX-this.getPath("owner.dragStartX"),i=this.getPath("owner.startX")+r;i<30&&(i=30);var s;if(this.getPath("owner.type")==="column")s=parseInt(n.attr("data-leaf-index"),10)+1,n.parents("table").find("colgroup :nth-child(%@)".fmt(s)).css("width","%@px".fmt(i)),this.get("owner")._synchronizeColumnWidth();else{var o=this.getPath("owner.offset")+r-2;o<30&&(o=30);if(jQuery.browser.mozilla)o-=1;else if(jQuery.browser.webkit||jQuery.browser.msie)o-=2;this.getPath("owner.scrollable").css("left","%@px".fmt(o)),this.getPath("owner.columnHeader").parent().css("left","%@px".fmt(o)),this.getPath("owner.tableCorner").css("width","%@px".fmt(o));var u=this.getPath("owner.rowDepth");s=u-n.nextAll().length,n.parents("table").find("colgroup :nth-child(%@)".fmt(s)).css("width","%@px".fmt(i))}},mouseUp:function(e){var t=this.get("owner");if(t.get("type")==="column"){var n=t.get("resizeDelegate");if(n&&n.columnResized){var r=t.get("resizingCell"),i=parseInt(r.css("width"),10),s=parseInt(r.attr("data-leaf-index"),10);n.columnResized(s,i)}}return this.gotoState("idle"),!0}}),_synchronizeColumnWidth:function(){var e=this.get("resizingCell"),t=this.get("childViews")[0],n=parseInt(e.css("width"),10),r=parseInt(e.attr("data-leaf-index"),10);if(jQuery.browser.webkit||jQuery.browser.msie)n+=4;jQuery.browser.mozilla&&(n-=2),t.updateColumnWidth(r,n)},willInsertElement:function(){var e=this.get("scrollable");e&&e.unbind()},didInsertElement:function(){this.set("scrollable",this.$(".flame-table").parent().parent()),this.set("rowHeader",this.$(".row-header table")),this.set("columnHeader",this.$(".column-header table")),this.set("tableCorner",this.$(".table-corner")),this.get("scrollable").scroll({self:this},this.didScroll)},didScroll:function(e){var t=e.data.self,n=t.get("scrollable");t.get("rowHeader").css("top","-%@px".fmt(n.scrollTop())),t.get("columnHeader").css("left","-%@px".fmt(n.scrollLeft()))},_headersDidChange:function(){this.rerender()}.observes("contentAdapter.headers"),render:function(e){this._renderElementAttributes(e);var t=this.get("renderColumnHeader"),n=this.get("renderRowHeader"),r=!1,i=this.getPath("contentAdapter.headers");if(!i)return;this.getPath("content.title")&&(e=e.push('<div class="panel-title">%@</div>'.fmt(this.getPath("content.title"))),r=!0);var s=this.get("defaultColumnWidth"),o=this.getPath("contentAdapter.columnHeaderRows"),u=this.getPath("contentAdapter.rowHeaderRows"),a=o.maxDepth*21+1+o.maxDepth,f=0;n&&(f=u.maxDepth*s+1+(t?0:5));var l=r?18:0;t&&(e=e.push('<div class="table-corner" style="top: %@px; left: 0px; height: %@px; width: %@px;"></div>'.fmt(l,a,f)),e=this._renderHeader(e,"column",f,s),l+=a),n&&(e=this._renderHeader(e,"row",l,s)),e=e.begin("div").attr("style","overflow: auto; bottom: 0px; top: %@px; left: %@px; right: 0px;".fmt(l,f)),e=e.attr("class","scrollable"),this.forEachChildView(function(t){t.renderToBuffer(e)}),e=e.end()},_renderHeader:function(e,t,n,r){var i=this.getPath("contentAdapter.headers");if(!i)return e.begin("div").end();var s,o;t==="column"?(i=this.getPath("contentAdapter.columnHeaderRows"),s="left"):(i=this.getPath("contentAdapter.rowHeaderRows"),s="top");var u=i.length;e=e.begin("div").addClass("%@-header".fmt(t)).attr("style","position: absolute; %@: %@px".fmt(s,n)),e=e.begin("table").attr("style","position: absolute").attr("width","1px"),e=e.begin("colgroup");if(t==="row")for(o=1;o<4;o++)e=e.push('<col style="width: %@px;" class="level-%@" />'.fmt(r,o));else{var a=this.getPath("content.columnLeafs").length;for(o=0;o<a;o++)e=e.push('<col style="width: %@px;" />'.fmt(this.getPath("content.columnLeafs")[o].get("render_width")||r))}e=e.end();for(o=0;o<u;o++)e=e.begin("tr"),t==="column"&&(e=e.attr("class","level-%@".fmt(o+1))),e=this._renderRow(e,i[o],t,o),e=e.end();return e=e.end().end(),e},_renderRow:function(e,t,n,r){var i=t.length,s,o,u;for(var a=0;a<i;a++){var f=t[a];e=e.begin("td"),u=f.get?f.get("headerLabel"):f.label,e=e.attr("title",u),f.rowspan>1&&(e=e.attr("rowspan",f.rowspan)),f.colspan>1&&(e=e.attr("colspan",f.colspan)),s='<div class="label">%@</div>',e.attr("class",a%2===0?"even-col":"odd-col"),n==="column"&&!f.hasOwnProperty("children")?(e=e.attr("data-index",a),e=e.attr("data-leaf-index",f.leafIndex),this.get("isResizable")&&this.get("renderColumnHeader")&&(e=e.push('<div class="resize-handle">&nbsp;</div>')),s='<div class="label">%@',o&&(s+='<img src="%@" style="vertical-align: middle" />'.fmt(o)),s+="</div>"):n==="row"&&(e=e.attr("data-index",r%this.getPath("content.rowLeafs").length),this.get("renderColumnHeader")&&(this.get("isResizable")&&(f.hasOwnProperty("children")?e=e.push('<div class="resize-handle" style="height: %@px"></div>'
build/flame.js:    classNames: ['flame-table-data-view'],
build/flame.js:        var classes = 'flame-table';
build/flame.js:        var table = this.$('table.flame-table');
build/flame.js:    classNames: 'flame-table-view'.w(),
build/flame.js:        this.set('scrollable', this.$('.flame-table').parent().parent());
build/stylesheets/flame.css:.flame-table-view {
build/stylesheets/flame.css:  .flame-table-view .table-corner {
build/stylesheets/flame.css:  .flame-table-view .scrollable {
build/stylesheets/flame.css:  .flame-table-view a {
build/stylesheets/flame.css:  .flame-table-view tr {
build/stylesheets/flame.css:  .flame-table-view td {
build/stylesheets/flame.css:  .flame-table-view div {
build/stylesheets/flame.css:  .flame-table-view div.resize-handle {
build/stylesheets/flame.css:  .flame-table-view div.table-selection {
build/stylesheets/flame.css:  .flame-table-view div.read-only {
build/stylesheets/flame.css:  .flame-table-view table {
build/stylesheets/flame.css:  .flame-table-view .flame-table {
build/stylesheets/flame.css:    .flame-table-view .flame-table.is-selectable {
build/stylesheets/flame.css:  .flame-table-view .flame-table-data-view {
build/stylesheets/flame.css:    .flame-table-view .flame-table-data-view td {
build/stylesheets/flame.css:      .flame-table-view .flame-table-data-view td.is-total {
build/stylesheets/flame.css:        .flame-table-view .flame-table-data-view td.is-total.is-double-total {
build/stylesheets/flame.css:      .flame-table-view .flame-table-data-view td.is-updating {
build/stylesheets/flame.css:  .flame-table-view .column-header .label {
build/stylesheets/flame.css:  .flame-table-view .column-header td {
build/stylesheets/flame.css:  .flame-table-view .column-header tr.level-1 td {
build/stylesheets/flame.css:  .flame-table-view .column-header tr.level-2 td {
build/stylesheets/flame.css:  .flame-table-view .column-header tr.level-3 td {
build/stylesheets/flame.css:  .flame-table-view .row-header td {
build/stylesheets/flame.css:  .flame-table-view .row-header col.level-1 {
build/stylesheets/flame.css:  .flame-table-view .row-header col.level-2 {
build/stylesheets/flame.css:  .flame-table-view .row-header col.level-3 {
build/stylesheets/flame.css:  .flame-table-view input {
build/stylesheets/flame.css:    .flame-table-view input.invalid {
build/stylesheets/flame.css:    .flame-table-view input.table-edit-field {
stylesheets/flame.css.scss:.flame-table-view {
stylesheets/flame.css.scss:    .flame-table {
stylesheets/flame.css.scss:    .flame-table-data-view {
views/table_data_view.js:    classNames: ['flame-table-data-view'],
views/table_data_view.js:        var classes = 'flame-table';
views/table_data_view.js:        var table = this.$('table.flame-table');
views/table_view.js:    classNames: 'flame-table-view'.w(),
views/table_view.js:        this.set('scrollable', this.$('.flame-table').parent().parent());
